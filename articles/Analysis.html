<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EndoMineR">
<title>Analysis • EndoMineR</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis">
<meta property="og:description" content="EndoMineR">
<meta property="og:image" content="https://docs.ropensci.org/EndoMineR/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">EndoMineR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/EndoMineRPrinciples.html">EndoMineR Principles</a>
    <a class="dropdown-item" href="../articles/EndoMineR.html">Package overview</a>
    <a class="dropdown-item" href="../articles/Analysis.html">Analysis</a>
    <a class="dropdown-item" href="../articles/Barretts.html">Barrett's</a>
    <a class="dropdown-item" href="../articles/Polyps.html">Lower GI Polyps</a>
    <a class="dropdown-item" href="../articles/Data.html">Data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://gastrodatascience.com">
    <span class="fa fa fa fa-bullseye"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/GastroDS">
    <span class="fa fa fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/EndoMineR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://www.gastroenterologybook.com/">
    <span class="far fa far fa-book"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.nhs.uk/profiles/consultant/6029157">
    <span class="fas fa fas fa-stethoscope"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analysis</h1>
                        <h4 data-toc-skip class="author">Sebastian Zeki</h4>
            
            <h4 data-toc-skip class="date">March 04, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/EndoMineR/blob/HEAD/vignettes/Analysis.Rmd" class="external-link"><code>vignettes/Analysis.Rmd</code></a></small>
      <div class="d-none name"><code>Analysis.Rmd</code></div>
    </div>

    
    
<p><br> A fundamental design principle of EndoMineR was that it should address the important categories of questions we all have in gastroenterology, and endoscopy in particular. These questions roughly fall into the following: surveillance, quality and also operational questions (eg patient flow through endoscopy).</p>
<p>##<strong>1. Surveillance functions</strong></p>
<p><br> Surveillance tracking is difficult because it relies on assessment at several timepoint and then deciding on the next examination based on a ruleset. A basic question is often: ’How good are our surveillance programmes?” which really means “How good are we at making sure patients come back in a timely way for their endoscopy after a polyp removal or for Barrett’s surveillance”, for example?</p>
<p><br></p>
<p><img src="img/EndoMineR_Surveillance.svg" style="display: block; margin: auto;"></p>
<p><br></p>
<p>Surveillance relates to the timing of a test relative to other tests or all tests done for a patient. To do this, the EndoMineR surveillance functions simply order the endoscopies by patient and date, and extract the date the first test was done, as well as the last test (of the same type) and the difference in timing between each test, always grouped by patient.</p>
<p><br> As all these functions are simply looking at the date of the test, they can take a raw dataset, as long as a date column is present and use that, rather than have a lot of pre-processing steps. Of course, the pre-processing steps explained in the EndoMineR vignette (mainly using the <strong>textPrep</strong> function) are recommended however as then the user will be able to perform any other additional analyses if needed.</p>
<p><br> The basic surveillance functions are simple but are the most used. <strong>SurveilTimeByRow</strong> will extract the time difference between each individual endoscopy for an individual patient. This is useful to see how adherent the surveillance endoscopy is to guidelines.</p>
<p><br></p>
<p><strong>SurveilLastTest</strong> simply extracts the last and first test respectively for each patient so you can assess how long the patient has been surveilled for. This is likely to come in useful for future iterations of EndoMineR as patient Theographs are developed (work in progress).</p>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/SurveilTimeByRow.html">SurveilTimeByRow</a></span><span class="op">(</span><span class="va">Myendo</span>,<span class="st">'HospitalNumber'</span>,<span class="st">'Dateofprocedure'</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<table style="width:47%;" class="table">
<colgroup>
<col width="23%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="center">HospitalNumber</th>
<th align="center">TimeSinceLast</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">A1648588</td>
<td align="center">2997 days</td>
</tr>
<tr class="even">
<td align="center">A1648588</td>
<td align="center">2997 days</td>
</tr>
<tr class="odd">
<td align="center">A1648588</td>
<td align="center">2997 days</td>
</tr>
<tr class="even">
<td align="center">A1648588</td>
<td align="center">2997 days</td>
</tr>
<tr class="odd">
<td align="center">A1648588</td>
<td align="center">2997 days</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em3</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/SurveilLastTest.html">SurveilLastTest</a></span><span class="op">(</span><span class="va">Myendo</span>,<span class="st">'HospitalNumber'</span>,<span class="st">'Dateofprocedure'</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<table style="width:49%;" class="table">
<colgroup>
<col width="23%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="center">HospitalNumber</th>
<th align="center">Dateofprocedure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">J1337672</td>
<td align="center">2013-03-25</td>
</tr>
<tr class="even">
<td align="center">Q7176341</td>
<td align="center">2014-05-31</td>
</tr>
<tr class="odd">
<td align="center">M5148114</td>
<td align="center">2014-06-18</td>
</tr>
<tr class="even">
<td align="center">Q7729897</td>
<td align="center">2014-07-19</td>
</tr>
<tr class="odd">
<td align="center">R3882435</td>
<td align="center">2014-11-15</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em4</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/SurveilFirstTest.html">SurveilFirstTest</a></span><span class="op">(</span><span class="va">Myendo</span>,<span class="st">'HospitalNumber'</span>,<span class="st">'Dateofprocedure'</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<table style="width:49%;" class="table">
<colgroup>
<col width="23%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="center">HospitalNumber</th>
<th align="center">Dateofprocedure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">F7957976</td>
<td align="center">2001-01-03</td>
</tr>
<tr class="even">
<td align="center">Y8594667</td>
<td align="center">2001-01-04</td>
</tr>
<tr class="odd">
<td align="center">Z6299612</td>
<td align="center">2001-01-08</td>
</tr>
<tr class="even">
<td align="center">R8004923</td>
<td align="center">2001-01-15</td>
</tr>
<tr class="odd">
<td align="center">U1759838</td>
<td align="center">2001-01-16</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Of course we may also want to know how many tests have been done over a time period and this is provided by the function <strong>HowManyTests</strong></p>
<p><br></p>
<p>This function will return the number of tests by day, month and year so they can be easily graphed according to what you want.</p>
<p><br></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">how</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/HowManyOverTime.html">HowManyOverTime</a></span><span class="op">(</span><span class="va">Myendo</span>,<span class="st">'Indications'</span>,<span class="st">'Dateofprocedure'</span>,<span class="st">'Surv'</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<table style="width:67%;" class="table">
<colgroup>
<col width="8%">
<col width="9%">
<col width="11%">
<col width="9%">
<col width="9%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="center">day</th>
<th align="center">week</th>
<th align="center">month</th>
<th align="center">year</th>
<th align="center">freq</th>
<th align="center">MonthYear</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">25</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">2001</td>
<td align="center">1</td>
<td align="center">2001-01-01</td>
</tr>
<tr class="even">
<td align="center">27</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">2001</td>
<td align="center">1</td>
<td align="center">2001-01-01</td>
</tr>
<tr class="odd">
<td align="center">23</td>
<td align="center">12</td>
<td align="center">3</td>
<td align="center">2001</td>
<td align="center">1</td>
<td align="center">2001-03-01</td>
</tr>
<tr class="even">
<td align="center">11</td>
<td align="center">15</td>
<td align="center">4</td>
<td align="center">2001</td>
<td align="center">1</td>
<td align="center">2001-04-01</td>
</tr>
<tr class="odd">
<td align="center">20</td>
<td align="center">16</td>
<td align="center">4</td>
<td align="center">2001</td>
<td align="center">1</td>
<td align="center">2001-04-01</td>
</tr>
</tbody>
</table>
<div class="section level2">
<h2 id="assessment-of-quality-functions">
<strong>2. Assessment of quality functions</strong><a class="anchor" aria-label="anchor" href="#assessment-of-quality-functions"></a>
</h2>
<p><br></p>
<p>Quality is measured in a variety of ways. For endoscopy it is measured according to the adherence to a) standards for endoscopic documentation as well as b) detection of certain pathological conditions such as dysplasia (best summarised as lesion recognition)</p>
<p><br></p>
<div class="section level3">
<h3 id="a-documentation-quality">
<strong>a) Documentation Quality</strong><a class="anchor" aria-label="anchor" href="#a-documentation-quality"></a>
</h3>
<p><br></p>
<p>As regards adherence to documentation for example, a generic function is provided that will look up the presence of words presented in a list in a target column. It will then output the proportion of reports that have these words, as well as a barchart to show what proportion of the endoscopies showed these words. The list can be comprised of terms that should be mentioned in a report.</p>
<p><br></p>
<p><em>Input</em></p>
<table class="table">
<colgroup>
<col width="23%">
<col width="31%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th align="center">HospitalNumber</th>
<th align="center">PatientName</th>
<th align="center">Findings</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">J6044658</td>
<td align="center">Jargon, Victoria</td>
<td align="center">No evidence of Barrett’s oesophagus, short 2 cn hiatus hernia ,Oesophageal biopsies taken from three levels as requested ,OGD today to assess for ulceration/ongoing bleeding ,Diaphragmatic pinch:40cm ,She has a small hiatus hernia ,We will re-book for 2 weeks, rebanding ,Tiny erosions at the antrum ,Biopsies taken from top of stricture-metal marking clips in situ ,The varices flattened well with air insufflation ,He is on Barrett’s Screeling List in October 2017 at St Thomas’ HALO 90 done with good effect</td>
</tr>
<tr class="even">
<td align="center">Y6417773</td>
<td align="center">Powell, Destiny</td>
<td align="center">Duodenum: Duodenitis with a small erosion ,STOMACH: diffuse gastritis with angiodysplasia and punctate bleeding site on greater curve mid body - no obvious ulcer- antrum scar ?,No immediate complications ,Z-line at: 38cm - Bravo placed at 32cm- good positionat check endoscopy</td>
</tr>
<tr class="odd">
<td align="center">B6072011</td>
<td align="center">Martinez-Santos, Ana</td>
<td align="center">Stomach- Body Polyp- Pedunculated ,Several erosions/small ulcers in inflammed antrum ,Lax cardia with small hiatus hernia but no erosive oesophagitis ,DUODENUM: Normal to D3</td>
</tr>
<tr class="even">
<td align="center">G1449886</td>
<td align="center">Lopez, Maria</td>
<td align="center">STOMACH: Small amount of bright red blood that seems to have refluxed back through the pylorus</td>
</tr>
<tr class="odd">
<td align="center">V1607560</td>
<td align="center">al-Rahimi, Rif’a</td>
<td align="center">Coffee ground vomit ,OESOPHAGUS: the previous subepithelial lesion measuring 1 TTS HALO to area</td>
</tr>
<tr class="even">
<td align="center">I8031481</td>
<td align="center">Forrest, Dazheea</td>
<td align="center">Stomach- Pylorus ,No cervical inlet patch</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>In this example we are looking for the words Barrett’s and coeliac as perhaps we have chosen the macroscopic recognition of these features to denote what an endoscopist should always describe in the endoscopy report:</p>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a></span><span class="op">)</span></span>
<span><span class="va">myNotableWords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barrett"</span>, <span class="st">"coeliac"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ListLookup.html">ListLookup</a></span><span class="op">(</span><span class="va">Myendo</span>,<span class="st">'Findings'</span>,<span class="va">myNotableWords</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        X2  Prop</span></span>
<span><span class="co">## 1 barrett 18.05</span></span>
<span><span class="co">## 2 coeliac  6.20</span></span></code></pre>
<p><br></p>
<p><br></p>
<p>So we can see that the terms are present in the minority of reports across endoscopists, so perhaps we can look into this further..</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="b-endoscopic-quality">
<strong>b) Endoscopic Quality</strong><a class="anchor" aria-label="anchor" href="#b-endoscopic-quality"></a>
</h3>
<div class="section level4">
<h4 id="sedation-usage">
<strong>Sedation Usage</strong><a class="anchor" aria-label="anchor" href="#sedation-usage"></a>
</h4>
<p><br></p>
<p>Another measure of quality is the assessment of those factors that are recorded at endoscopy such as degree of sedation used etc. Rather than provide a function for each metric, again a generic function is provided that uses any quantifiable metric and plots it against the endoscopist. This function returns a list with two elements- the plot and the table:</p>
<p><br></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#We have to attach the output of EndoscMeds to the original dataframe</span></span>
<span><span class="va">MyendoNew</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="../reference/EndoscMeds.html">EndoscMeds</a></span><span class="op">(</span><span class="va">Myendo</span><span class="op">$</span><span class="va">Medications</span><span class="op">)</span>,<span class="va">Myendo</span><span class="op">)</span></span>
<span><span class="co">#Average Fentanyl use by endoscopist:</span></span>
<span><span class="va">Mytable</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/MetricByEndoscopist.html">MetricByEndoscopist</a></span><span class="op">(</span><span class="va">MyendoNew</span>,<span class="st">'Endoscopist'</span>,<span class="st">'Fent'</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<table style="width:65%;" class="table">
<colgroup>
<col width="41%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="center">MyendoNew.Endoscopist</th>
<th align="center">MyendoNew.Fent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Dr Sullivan, Shelby</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">Dr Kekich, Annabelle</td>
<td align="center">125</td>
</tr>
<tr class="odd">
<td align="center">Dr Sullivan, Shelby</td>
<td align="center">125</td>
</tr>
<tr class="even">
<td align="center">Dr Avitia-Ramirez, Alondra</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">Dr Greimann, Phoua</td>
<td align="center">75</td>
</tr>
<tr class="even">
<td align="center">Dr Avitia-Ramirez, Alondra</td>
<td align="center">150</td>
</tr>
<tr class="odd">
<td align="center">Dr Martinez, Maegen</td>
<td align="center">125</td>
</tr>
<tr class="even">
<td align="center">Dr Anderson, Alana</td>
<td align="center">75</td>
</tr>
<tr class="odd">
<td align="center">Dr Anderson, Alana</td>
<td align="center">25</td>
</tr>
<tr class="even">
<td align="center">Dr Ives, Rashiah</td>
<td align="center">150</td>
</tr>
</tbody>
</table>
<p><br><br></p>
<p><br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="patient-flow-functions">
<strong>4.Patient flow functions</strong><a class="anchor" aria-label="anchor" href="#patient-flow-functions"></a>
</h2>
<p><br></p>
<div class="section level3">
<h3 id="sankey-plots">
<strong>Sankey plots</strong><a class="anchor" aria-label="anchor" href="#sankey-plots"></a>
</h3>
<p><br></p>
<p>We often like to get an overview of how patients are flowing through a system overall. This can give a nice visual representation of whether which patients diverge from the normal flow through a system so we can study them further. There are two ways to look at this. Sankey plots give good timepoint by timepoint representation of flow. This really works with more than one type of event at each timepoint.</p>
<p><br></p>
<p>For example, if we have a dataset with events such as ‘radiofrequency ablation’ and ‘endoscopic mucosal resection’ or ‘nothing’ we can use the Sankey plot to determine the order of events over a large patient population. You choose the column in the dataframe that describes the Procedure type (“EMR”,“RFA”,“nothing” in this case)</p>
<p><br></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#how&lt;-SurveySankey(Myendo,"ProcedurePerformed")</span></span></code></pre></div>
<p><br></p>
<p><img src="img/EndoMineR_Sankey.svg" width="100%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="circos-plots">
<strong>Circos plots</strong><a class="anchor" aria-label="anchor" href="#circos-plots"></a>
</h3>
<p><br></p>
<p>We may need something even more aggregated. Perhaps we want to see the overall number of patients that go from one event to another regardless of which timepoint it is at. To do this we can use a circos plot, which makes use of the circlize library, as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#flow&lt;-PatientFlow_CircosPlots(v,"Date.y","pHospitalNum","ProcedurePerformed")</span></span></code></pre></div>
<p><br></p>
<p><img src="img/EndoMineR_Circos.svg" width="60%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
